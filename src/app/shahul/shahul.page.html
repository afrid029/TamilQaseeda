<html class="addBody">
  <div class="tool shtool">
    <img class="img" alt="">
  </div>

  <ion-content>
    @if (spinner) {
<div style="position:fixed;transform: scale(2); display: flex; width:100%; height:100%; justify-content: space-around; align-items: center; z-index:4;
    opacity: 0.7;">
        <ion-spinner name="lines-small" [paused]="false" color="warning"></ion-spinner>
      </div>
    }

    <div class="main mainsh" style="background-color: rgb(139 126 126 / 39%);">
      <div class="bar barsh">

        <ion-button fill="clear" color="light" (click) = "redirect()"><ion-icon name="chevron-back-outline"></ion-icon>Back</ion-button>
        <ion-input style="font-style: italic; font-size: smaller;" class="search" [(ngModel)]="searchKey" (ionChange)="handleSearch()" placeholder="Search by keyword"><ion-icon  name="search"></ion-icon></ion-input>
        <ion-button fill="clear" color="dark" [disabled]="vis" (click)="clearSearch()">Clear</ion-button>

      </div>

      <ion-list class="lst lstsh">
        <div class="lstcont lstcontsh">
          @if (anyContent) {
            <div style="height: 100%;">
              @if (obj) {
                <div class="cont contsh">
                  @for (song of songs; track song) {
                    <div>
                      <ion-item style="padding-bottom: 5px;">
                        <ion-label style="white-space: initial" (click) = "promo(song)">{{ song.title }}</ion-label>
                        <div (click) = "EditSong(song)" class="edit">
                          <ion-icon class="icon" name="pencil"></ion-icon>
                        </div>
                        <div (click) = "deleteSong(song)"  class="edit del">
                          <ion-icon class="icon" name="trash"></ion-icon>
                        </div>
                      </ion-item>
                    </div>
                  }
                </div>
              }
              @if (!obj) {
                <div class="cont contsh">
                  @for (song of songs; track song) {
                    <div>
                      <ion-item style="padding-bottom: 5px;" >
                        <ion-label style="white-space: initial" (click) = "promo(song)">{{ song.title }}</ion-label>
                      </ion-item>
                    </div>
                  }
                </div>
              }
              @if (songs.length === 0) {
                <div style="width: 100%; height: 70%; position: fixed; display: flex; justify-content: space-around;align-items: center;" >
                  <ion-chip style="width:76%;">
                    <ion-label style="margin: 0 auto; text-align: center"><ion-icon name="search-outline"></ion-icon>&nbsp; தேடல் கிடைக்கவில்லை.</ion-label>
                  </ion-chip>
                </div>
              }
            </div>
          }
          @if (!anyContent) {
            <div class="cont">
              <ion-chip style="width:95%; top:48%">
                <ion-label style="margin: 0 auto;" >பாடல்கள் விரைவில் இணைக்கப்படும்</ion-label>
              </ion-chip>
            </div>
          }
        </div>
      </ion-list>


    </div>


    <ion-modal  backdropDismiss="false" mode="md" [isOpen]="isModalOpen">
      <ng-template>

        <ion-toolbar color="success">
          <ion-title style="font-size: 14px">{{ currSong.title }}</ion-title>
          <ion-buttons slot="end">
            <ion-button (click)="setOpen(false)">Close</ion-button>
          </ion-buttons>
        </ion-toolbar>

        <ion-content class="ion-padding modalBody">
          <ion-chip class="auth">
            <ion-label style="color: black;"><b>தொகுப்பு / ஆக்கம் : </b><br><br>{{ currSong.author ? currSong.author : 'Unknown' }}</ion-label>
          </ion-chip>
          <p style="white-space: pre-line; text-align: center;"> {{ currSong.content }}
          </p>
        </ion-content>
      </ng-template>
    </ion-modal>


    <!-- Edit Model -->
    <ion-modal backdropDismiss="false" [isOpen]="isEditOpen">
      <ng-template>


        <ion-toolbar color="warning">
          <ion-input (ionChange) = "onFieldChange()" [(ngModel)] = "editSong.title" required></ion-input>

          <div style="padding-right: 5px;" slot="end">
            <ion-button type="submit"  (click) = "updateSong()" [disabled] = "submitButton"  type="submit" size = "small" color="success">Save</ion-button>
            <ion-button size = "small" color="danger"  (click)="setOpen(false)">Close</ion-button>
          </div>
        </ion-toolbar>

        <ion-content class="ion-padding modalBody">


          <ion-chip class="auth" >
            <ion-input style=" color: black" (ionChange) = "onFieldChange()" required [(ngModel)] = "editSong.author"><b>தொகுப்பு / ஆக்கம் : </b><br><br> </ion-input>
          </ion-chip>
          <ion-textarea  (ionChange) = "onFieldChange()" required [(ngModel)] = "editSong.content" style="white-space: pre-line; text-align: center;  color: black" [autoGrow] = "true"></ion-textarea>
        </ion-content>

      </ng-template>
    </ion-modal>
  </ion-content>
</html>
